# 类型
Go 是一门强类型的静态编程语言。使用Go编程，我们的每一行代码几乎都离不开**类型**。
<a name="PHnSw"></a>
# 类型系统
为什么会有类型？类型可以带来哪些好处呢？**类型是高级语言有别于机器语言与低级语言的一种重要的抽象**。<br />![](https://cdn.nlark.com/yuque/0/2022/jpeg/362867/1671778064893-d6e2a1e9-22d2-4fc2-8898-dfb7ce6e0575.jpeg)

- 从机器的视角来看，所有类型数据都是`0101`的二进制数据，但直接用机器语言编码难度非常大且效率极其低下；
- 汇编语言，将层次提升到了面向多字节数据的编码，汇编指令的操作数都是固定长度字节的（比如：movb操作的是一个字节，movl操作的是四个字节）。汇编指令并不关心真实存储的是什么数据，**只是在各个地址之间搬移特定长度的数据**。汇编的抽象层次依旧不高，直接用汇编写程序依然有很大难度以及较为低效。
- 高级语言，建立了**类型**抽象，屏蔽了机器层面数据的复杂表示。类型下面的复杂的字节和比特操作由高级语言的编译器和运行时协助完成，**只需面向类型进行编码即可，类型成为了开发者与编译器之间的“操作界面”**。

![](https://cdn.nlark.com/yuque/0/2022/jpeg/362867/1671778783068-0ecfb946-015a-4370-aa4c-d3ef12a60af8.jpeg)<br />面向类型编程，需要了解类型的能力、其所代表的抽象的含义以及遵循类型的使用规则/约束。

- 类型决定了可以在该类型实例中存储的值的范围；
- 类型决定了可以对该类型进行的操作；
- 类型决定了该类型的变量需要的存储空间；
- 类型决定了与其他类型间建立连接的方法：组合、“继承”还是接口实现等。

编程语言的**类型系统**赋予了类型这些能力、规则与约束。<br />**类型系统是高级语言的核心，它存在于语言规范中，向开发者明确了类型的能力、使用规则与约束；它存在于编译器中，保证开发者对类型的正确合规使用；它也存在于语言运行时里，为类型提供如多态这样的动态能力。**<br />高级编程语言用类型系统赋能类型并管理类型，不同语言的类型系统的设计与实现有较大差别。
<a name="POBr3"></a>
# Go 类型系统
<a name="ic0Lj"></a>
## 类型定义
Go 内置了原生类型：

- 整型
- 浮点
- 复数
- 字符串
- 函数

提供了复合类型:

- array
- slice
- map
- struct
- channel

代表行为抽象的类型:

- 接口

通过 Go 提供的`type`关键字，还可以自定义类型和类型别名。
> - 自定义类型与其底层类型(underlying type)是两个完全不同的类型，
> - 类型别名并未引入新类型，与原类型等价。

<a name="Ri3fW"></a>
## 类型推导
Go 类型系统支持自动类型推导能力，编译器可以推断出变量或函数的类型，而不需要明确指定，除了支持普通类型推导，Go 还支持泛型的自动类型实参推导。
<a name="AC0LC"></a>
## 类型检查
Go 是一门强类型静态编程语言，意味着每个变量在使用之前都必须声明其类型。有了类型后，就可以按照 Go 类型系统规定的针对这个类型有效操作对其进行操作。<br />Go 编译器以及运行时会分别在编译期间和运行期间对变量类型作检查，目的是确保操作只用于正确的类型，并且类型系统的规则被程序所遵守，保证类型安全等。<br />Go 没有隐式类型转换，所有类型转换都要以明确意图的显式类型转换来实施，Go 编译器会在编译期间对类型转换进行检查，只有底层类型兼容的两个类型才可以实施显式转型。<br />除了编译期间的**静态检查**之外，Go类型系统还支持运行时**动态类型检查**，比如：

- 检查传给接口变量的类型实例是否实现了该接口；
- 对数组、切片类型的下标边界进行检查，确保下标不越界，保证内存安全等。

Go 也提供了绕过类型系统检查的手段，比如`unsafe.Pointer`以及反射等。
<a name="MoYfY"></a>
## 类型连接
Go 不是经典的面向对象编程语言，它的类型虽然可以拥有自己的**方法**(method)，但 Go 却没有提供经典面向对象中的复杂的**继承**层次结构，没有父类，没有子类，更没有供类型初始化的**构造函数**。<br />在 Go 的类型系统中，类型之间建立连接的方式只有**组合**，通过**类型嵌入**(type embedding)，可以实现各类组合，可以嵌入非接口类型，亦可以嵌入接口来定义新组合后的类型。<br />通过类型组合，可以将各种类型连接在一起，共同对外提供聚合后的行为，包括**多态**能力。Go 中标准的多态能力由`interface`类型实现，方法在运行时被分派，这取决于传给接口类型变量的具体类型。<br />Go 中的函数是一等公民，函数类型也展现出一定的运行时**多态**能力，函数类型实例的最终执行结果取决于运行时传入的函数对象值。
